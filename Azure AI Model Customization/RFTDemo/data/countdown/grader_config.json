{
    "name": "countdown_match_grader",
    "type": "multi",
    "graders": {
        "countdown_check":{
            "name": "custom grader",
            "type": "score_model",
            "model": "o3-mini",
            "input": [
                {
                    "type": "message",
                    "role": "developer",
                    "content": {
                        "type": "input_text",
                        "text": "You are a mathematical evaluator. Given a reference target number, a list of input numbers, and a model's output (an arithmetic expression and its reported result), your task is to evaluate the correctness and closeness of the model's answer.\n\nInput values are passed in as **strings**, including the number list and target. You must:\n1. Convert the `target` string to a number.\n2. Convert the `numbers` string (e.g., '[100, 75, 50, 25, 6, 3]') into an actual list of numbers.\n3. Parse and validate the `output_expression` — ensure it is a valid arithmetic expression.\n4. Evaluate the expression yourself and confirm it matches the model's reported `output_result`.\n5. Check that **all input numbers are used exactly once** — no missing, extra, or repeated numbers.\n6. Compare the evaluated result with the target and assign a score.\n\nScoring Rules:\n- 5: Expression is valid, numbers used exactly once, result matches target.\n- 4: Off by ±1, but everything else is correct.\n- 3: Off by ±2 to ±5, with correct number usage and syntax.\n- 2: Off by more than 5, but expression is valid and uses all numbers.\n- 1: Minor issues — e.g., result mismatch or slightly incorrect number usage.\n- 0: Major issues — invalid expression, incorrect number usage, or wrong result.\n\nOutput Format:\nScore: <0 - 5>\nReasoning: <brief justification>\n\nOnly respond with the score and reasoning."
                    }
                },
                {
                    "type": "message",
                    "role": "user",
                    "content": {
                        "type": "input_text",
                        "text": "{ \"target\": {{item.target}}, \"numbers\": {{item.nums}}, \"output\": {{sample.output_text}}}"
                    }
                }
            ],
            "pass_threshold": 5,
            "range": [0.0, 5.0]
        }
    },
    "calculate_output": "countdown_check"
}